# 公网IP、DMZ配置/端口映射等问题解决教程

作者：daoying007 <daoying007@gmail.com>

作者 ETH 地址：`0xC53D71abA6C29F284836d76Df75a4967Cd96acf9` 欢迎打赏


## 配置说明

### 第一步：确定运营商给你开通了独立公网IP
打电话给宽带运营商要求开通，我家是广州电信的，打电话给 `10000` 号，人工服务，要求开通公网IP，对方很爽快的说可以，大概5分钟后就开通了。开通后需要重启下光猫（直接拔光猫电源，再插上就可以了）


### 第二步：检查挖矿程序是否正常启动
使用如下命令（使用telent测试本机`13666`端口是否正常开启服务）：
   ```bash
   telnet 127.0.0.1 13666
   ```
   如果返回类似如下提示，表示你的挖矿程序应该是正常启动了，可以进行第二步了；否则表示挖矿程序启动有问题，请先解决程序启动问题（不在本教程范围）：
   ```bash
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
   ```


### 第三步：检查能否通过公网IP访问矿机

1. 查看公网IP：
打开网址 https://www.ipip.net/ip.html 就能看到你的公网IP

2. 使用如下命令检查能否通过公网IP访问矿机：
```bash
   telnet 公网IP 13666
```

上面命令行中的`公网IP`请改成你的公网IP，如果返回类似如下字符，说明你的公网问题已经解决了；否则表示公网配置是有问题的，请继续第四步：
```bash
Trying 公网IP...
Connected to 公网IP.
Escape character is '^]'.
```
#### ！！！注意：建议使用和矿机不在同一个内网的机器来测试（因为我自家在同一个网络的机器是不能通过外网IP连接到自己内网的其他机器或者本机的，用其他网络的机器就可以连上，不确定是否电信光猫的原因。所以我也是使用其他网络的机器给矿机刷单的）。可以使用手机共享4G热点给另一台电脑来做测试。


### 第四步：配置【自有路由器】的DMZ
！！！如果你的矿机是直接连光猫的（没有经过路由器），可以忽略本步骤。

将路由器的DMZ主机配置成你的矿机内网IP，以下是我的路由配置DMZ的地方。不同的路由器配置略有差异，需要自己去找到自己路由器配置DMZ的地方。
![自有路由器DMZ配置](https://raw.githubusercontent.com/daoying007/lambda-miner-tools/master/network-config/images/3.png)
如果配置后没有生效，可以试下重启路由器。


### 第五步：配置【光猫路由器】的DMZ
#### ！！！这一步是多数人都不知道的，应该也是很多人的问题所在
目前很多光猫都是内置路由器的（如果你家的光猫是没有路由功能的，可以忽略本步骤），我家是广州电信的宽带，必须要配置光猫的DMZ，否则外网是无法访问矿机的。不同运营商可能不一样，应该大多数电信用户和我是一样的，以下是我家的光猫路由器的DMZ方法，供你参考，可能不是完全一样，但应该是大同小异。

1. 打开【光猫路由器】配置网址：http://192.168.1.1/ 你可以试下这个网址，不同地区、运营商的【光猫路由器】访问网址可能不一样，可以咨询宽带运营商
2. 输入超级管理员（必须要超级管理员账号，光猫上帖着的那个普通账号是不行的）账号：`telecomadmin`，密码：`nE7jA%5m`，大多数电信宽带都是这个账号和密码，如果你的不行，请电话咨询你的宽带运营商
3. 进入 `应用` -> `高级NET设置` -> `DMZ设置`，输入你的【自有路由器】的入口IP（如何查看【自有路由器】入口IP，请参考第4点），保存。如果配置后没有生效，可以试下重启光猫。
   ![自有路由器DMZ配置](https://raw.githubusercontent.com/daoying007/lambda-miner-tools/master/network-config/images/2.png)
4. 查看【自有路由器】的入口IP，访问你的路由器查看，不同路由器查看方式都不一样，下图是我的路由里查看入口IP的地方，我的是 `192.168.1.3` ，如果你家也是电信宽带，很大概率是和我的一样的。
   ![查看路由器IP](https://raw.githubusercontent.com/daoying007/lambda-miner-tools/master/network-config/images/1.png)
5. 配置好后，再使用【第三步】第2点，检查能否通过外网IP能否访问矿机


### 其他说明

1. 内网端口映射也可以实现DMZ一样的效果，如果你是小白，我建议你直接配置DMZ就行了，不用做内网端口映射。
2. 判断光猫有没有路由功能的方法：如果拨号的账号密码是在光猫里配置的，说明光猫是有路由器功能的；如果拨号的账号密码功能是在【自有路由器】是配置的，说明光猫没有路由器功能。
3. 上面说的都是以我家的宽带（广州电信光纤宽带）配置为例，不同地区、同步运营商可能会有差异，但原理应该类似。
4. 如果你的矿机的直连光猫的，那么上面光猫DMZ的IP请设置成你的矿机IP。


----

## 更多 daoying007 原创Lambda挖矿工具、教程

1. Lambda矿工自动化定时定向刷单工具及使用方法：https://github.com/daoying007/lambda-miner-tools/blob/master/fillbid/README.md
2. 解决官方挖矿进程偶尔异常挂掉工具及使用方法：https://github.com/daoying007/lambda-miner-tools/blob/master/monitor/README.md
3. 公网IP、DMZ配置/端口映射等问题解决教程：https://github.com/daoying007/lambda-miner-tools/blob/master/network-config/README.md
4. Lambda 挖矿程序 docker 镜像及使用文档：https://github.com/daoying007/lambda-miner-docker